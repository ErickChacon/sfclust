<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create stars dataset • sfclust</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create stars dataset">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sfclust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/sfclust.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vg02-additional-features.html">Additional features</a></li>
    <li><a class="dropdown-item" href="../articles/vg03-stars-object.html">Create stars dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applications</h6></li>
    <li><a class="dropdown-item" href="../articles/vg12-covid-usa.html">Weekly relative risk of COVID-19 in US states (2020)</a></li>
    <li><a class="dropdown-item" href="../articles/vg14-temp-canada.html">Standardized daily temperature at Canadian stations (1960–1994)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create stars dataset</h1>
            
      

      <div class="d-none name"><code>vg03-stars-object.Rmd</code></div>
    </div>

    
    
<p>Our package <code>sfclust</code> is designed to work with
spatio-temporal data structured as a <code>stars</code> object. In this
vignette, we demonstrate how to create and manipulate a basic
<code>stars</code> object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Loading required package: abind</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Loading required package: sf</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h2>
<p>To begin, we need data that varies across both regions and time. In
this example, we simulate such data for illustrative purposes, but in
practice, this would come from your study’s specific regions and time
periods.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">space</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html" class="external-link">st_make_grid</a></span><span class="op">(</span>cellsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2025-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 month"</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Next, we simulate variables associated with each region and time
point. In this case, we create values for <code>cases</code>,
<code>temperature</code>, and <code>precipitation</code>. Each variable
is stored in a matrix where rows correspond to regions and columns to
time points.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">precipitation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-stars-object">Creating a <code>stars</code> object<a class="anchor" aria-label="anchor" href="#creating-a-stars-object"></a>
</h2>
<p>We now use the simulated data to construct a <code>stars</code>
object. This object will contain spatial, temporal, and variable
dimensions. While there are several ways to build such objects, the
following method is commonly used:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_as_stars.html" class="external-link">st_as_stars</a></span><span class="op">(</span></span>
<span>  cases <span class="op">=</span> <span class="va">cases</span>, temperature <span class="op">=</span> <span class="va">temperature</span>, precipitation <span class="op">=</span> <span class="va">precipitation</span>,</span>
<span>  dimensions <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html" class="external-link">st_dimensions</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">space</span>, time <span class="op">=</span> <span class="va">time</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">stdata</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stars object with 2 dimensions and 3 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                     Min.    1st Qu.      Median        Mean     3rd Qu.</span></span>
<span><span class="co">#&gt; cases          86.000000 93.0000000 99.00000000 98.90000000 102.7500000</span></span>
<span><span class="co">#&gt; temperature    -2.060541 -0.4165786  0.06808151  0.02795936   0.5496759</span></span>
<span><span class="co">#&gt; precipitation  -1.676105 -0.7343718 -0.17034766 -0.09712102   0.4299561</span></span>
<span><span class="co">#&gt;                      Max.</span></span>
<span><span class="co">#&gt; cases          116.000000</span></span>
<span><span class="co">#&gt; temperature      1.766004</span></span>
<span><span class="co">#&gt; precipitation    2.106161</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;          from to refsys point</span></span>
<span><span class="co">#&gt; geometry    1  6     NA FALSE</span></span>
<span><span class="co">#&gt; time        1  5   Date FALSE</span></span>
<span><span class="co">#&gt;                                                                 values</span></span>
<span><span class="co">#&gt; geometry POLYGON ((0 0, 1 0, 1 1, ...,...,POLYGON ((2 1, 3 1, 3 2, ...</span></span>
<span><span class="co">#&gt; time                                         2025-01-01,...,2025-05-01</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="manipulating-a-stars-object">Manipulating a <code>stars</code> object<a class="anchor" aria-label="anchor" href="#manipulating-a-stars-object"></a>
</h2>
<p>Once the <code>stars</code> object is created, you can use any of the
methods provided by the <a href="https://r-spatial.github.io/stars/index.html" class="external-link"><code>stars</code></a>
package. For example, we can visualize the <code>cases</code> variable
across time:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/stars/reference/geom_stars.html" class="external-link">geom_stars</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cases</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">stdata</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdBu"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vg03-stars-object_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>You can also add additional variables to the <code>stars</code>
object. For instance, let’s add a <code>population</code> variable:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdata</span><span class="op">[</span><span class="st">"population"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1000</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">stdata</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stars object with 2 dimensions and 4 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                      Min.     1st Qu.        Median         Mean      3rd Qu.</span></span>
<span><span class="co">#&gt; cases           86.000000  93.0000000   99.00000000  98.90000000  102.7500000</span></span>
<span><span class="co">#&gt; temperature     -2.060541  -0.4165786    0.06808151   0.02795936    0.5496759</span></span>
<span><span class="co">#&gt; precipitation   -1.676105  -0.7343718   -0.17034766  -0.09712102    0.4299561</span></span>
<span><span class="co">#&gt; population     953.000000 975.0000000 1004.00000000 999.60000000 1028.0000000</span></span>
<span><span class="co">#&gt;                       Max.</span></span>
<span><span class="co">#&gt; cases           116.000000</span></span>
<span><span class="co">#&gt; temperature       1.766004</span></span>
<span><span class="co">#&gt; precipitation     2.106161</span></span>
<span><span class="co">#&gt; population     1038.000000</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;          from to refsys point</span></span>
<span><span class="co">#&gt; geometry    1  6     NA FALSE</span></span>
<span><span class="co">#&gt; time        1  5   Date FALSE</span></span>
<span><span class="co">#&gt;                                                                 values</span></span>
<span><span class="co">#&gt; geometry POLYGON ((0 0, 1 0, 1 1, ...,...,POLYGON ((2 1, 3 1, 3 2, ...</span></span>
<span><span class="co">#&gt; time                                         2025-01-01,...,2025-05-01</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erick A. Chacón-Montalván, Ruiman Zhong, Paula Moraga.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
