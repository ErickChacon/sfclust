<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian spatial functional clustering — sfclust • sfclust</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian spatial functional clustering — sfclust"><meta name="description" content="Bayesian detection of neighboring spatial regions with similar functional shapes using
spanning trees and latent Gaussian models. It ensures spatial contiguity in the
clusters, handles a large family of latent Gaussian models supported by inla, and
allows to work with non-Gaussian likelihoods."><meta property="og:description" content="Bayesian detection of neighboring spatial regions with similar functional shapes using
spanning trees and latent Gaussian models. It ensures spatial contiguity in the
clusters, handles a large family of latent Gaussian models supported by inla, and
allows to work with non-Gaussian likelihoods."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sfclust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/sfclust.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/vg01-stars-object.html">Create a stars dataset</a></li>
    <li><a class="dropdown-item" href="../articles/vg02-advanced-features.html">Advanced features</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applications</h6></li>
    <li><a class="dropdown-item" href="../articles/vg11-covid-usa.html">Weekly relative risk of COVID-19 in US states</a></li>
    <li><a class="dropdown-item" href="../articles/vg12-temp-canada.html">Standardized daily temperature at Canadian stations</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ErickChacon/sfclust/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian spatial functional clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/ErickChacon/sfclust/blob/main/R/model-cluster.R" class="external-link"><code>R/model-cluster.R</code></a></small>
      <div class="d-none name"><code>sfclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bayesian detection of neighboring spatial regions with similar functional shapes using
spanning trees and latent Gaussian models. It ensures spatial contiguity in the
clusters, handles a large family of latent Gaussian models supported by <code>inla</code>, and
allows to work with non-Gaussian likelihoods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sfclust</span><span class="op">(</span></span>
<span>  <span class="va">stdata</span>,</span>
<span>  graphdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geometry"</span>, <span class="st">"time"</span><span class="op">)</span>,</span>
<span>  move_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.425</span>, <span class="fl">0.425</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  logpen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  correction <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nmessage <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  path_save <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsave <span class="op">=</span> <span class="va">nmessage</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-stdata">stdata<a class="anchor" aria-label="anchor" href="#arg-stdata"></a></dt>
<dd><p>A stars object containing response variables, covariates, and other necessary data.</p></dd>


<dt id="arg-graphdata">graphdata<a class="anchor" aria-label="anchor" href="#arg-graphdata"></a></dt>
<dd><p>A list containing the initial graph used for the Bayesian model.
It should include components like <code>graph</code>, <code>mst</code>, and <code>membership</code> (default is <code>NULL</code>).</p></dd>


<dt id="arg-stnames">stnames<a class="anchor" aria-label="anchor" href="#arg-stnames"></a></dt>
<dd><p>A character vector specifying the spatio-temporal dimension names of
<code>stdata</code> that represent spatial geometry and time, respectively (default is
<code>c("geometry", "time")</code>).</p></dd>


<dt id="arg-move-prob">move_prob<a class="anchor" aria-label="anchor" href="#arg-move-prob"></a></dt>
<dd><p>A numeric vector of probabilities for different types of moves in the MCMC process:
birth, death, change, and hyperparameter moves (default is <code>c(0.425, 0.425, 0.1, 0.05)</code>).</p></dd>


<dt id="arg-logpen">logpen<a class="anchor" aria-label="anchor" href="#arg-logpen"></a></dt>
<dd><p>A negative numeric value representing the log-scale penalty for
increasing the number of clusters by one. The number of clusters is assumed to
follow a geometric prior with probability <code>q</code>, making this penalty equal to
<code>log(1 - q)</code>. For example, if <code>logp = -50</code>, then a proposal that increases the
number of clusters will only be favored if it improves the log marginal
likelihood by more than 50.</p></dd>


<dt id="arg-correction">correction<a class="anchor" aria-label="anchor" href="#arg-correction"></a></dt>
<dd><p>A logical indicating whether correction to compute the marginal
likelihoods should be applied (default is <code>TRUE</code>). This depend of the type of
effect inclused in the <code>INLA</code> model.</p></dd>


<dt id="arg-niter">niter<a class="anchor" aria-label="anchor" href="#arg-niter"></a></dt>
<dd><p>An integer specifying the number of MCMC iterations to perform (default is <code>100</code>).</p></dd>


<dt id="arg-burnin">burnin<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>An integer specifying the number of burn-in iterations to discard (default is <code>0</code>).</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>An integer specifying the thinning interval for recording the results (default is <code>1</code>).</p></dd>


<dt id="arg-nmessage">nmessage<a class="anchor" aria-label="anchor" href="#arg-nmessage"></a></dt>
<dd><p>An integer specifying how often progress messages should be printed (default is <code>10</code>).</p></dd>


<dt id="arg-path-save">path_save<a class="anchor" aria-label="anchor" href="#arg-path-save"></a></dt>
<dd><p>A character string specifying the file path to save the results (default is <code>NULL</code>).</p></dd>


<dt id="arg-nsave">nsave<a class="anchor" aria-label="anchor" href="#arg-nsave"></a></dt>
<dd><p>An integer specifying the number of iterations between saved results in the chain
(default is <code>nmessage</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments such as <code>formula</code>, <code>family</code>, and others that are passed
to the <code>inla</code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>sfclust</code> object containing two main lists: <code>samples</code> and <code>clust</code>.</p><ul><li><p>The <code>samples</code> list includes details from the sampling process, such as:</p><ul><li><p><code>membership</code>: The cluster membership assignments for each sample.</p></li>
<li><p><code>log_marginal_likelihood</code>: The log marginal likelihood for each sample.</p></li>
<li><p><code>move_counts</code>: The counts of each type of move during the MCMC process.</p></li>
</ul></li>
<li><p>The <code>clust</code> list contains information about the selected clustering, including:</p><ul><li><p><code>id</code>: The identifier of the selected sample (default is the last sample).</p></li>
<li><p><code>membership</code>: The cluster assignments for the selected sample.</p></li>
<li><p><code>models</code>: The fitted models for each cluster in the selected sample.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implementation draws inspiration from the methods described in the paper:
<em>"Bayesian Clustering of Spatial Functional Data with Application to a Human Mobility
Study During COVID-19"</em> by Bohai Zhang, Huiyan Sang, Zhao Tang Luo, and Hui Huang,
published in <em>The Annals of Applied Statistics</em>, 2023. For further details on the
methodology, please refer to:</p><ul><li><p>The paper: <a href="https://doi.org/10.1214/22-AOAS1643" class="external-link">doi:10.1214/22-AOAS1643</a></p></li>
<li><p>Supplementary material: <a href="https://doi.org/10.1214/22-AOAS1643SUPPB" class="external-link">doi:10.1214/22-AOAS1643SUPPB</a></p></li>
</ul><p>The MCMC algorithm in this implementation is largely based on the supplementary
material provided in the paper. However, we have generalized the computation of the
marginal likelihood ratio by leveraging INLA (Integrated Nested Laplace Approximation).
This generalization enables integration over all parameters and hyperparameters,
allowing for inference within a broader family of distribution functions and model
terms, thereby extending the scope and flexibility of the original approach.
Further details of our approach can be found in our paper <em>"Bayesian spatial functional
data clustering: applications in disease surveillance"</em> by Ruiman Zhong, Erick A.
Chacón-Montalván, Paula Moraga:</p><ul><li><p>The paper: <a href="https://arxiv.org/abs/2407.12633" class="external-link">https://arxiv.org/abs/2407.12633</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ruiman Zhong <a href="mailto:ruiman.zhong@kaust.edu.sa">ruiman.zhong@kaust.edu.sa</a>,
Erick A. Chacón-Montalván <a href="mailto:erick.chaconmontalvan@kaust.edu.sa">erick.chaconmontalvan@kaust.edu.sa</a>,
Paula Moraga <a href="mailto:paula.moraga@kaust.edu.sa">paula.moraga@kaust.edu.sa</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://erickchacon.github.io/sfclust" class="external-link">sfclust</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering with Gaussian data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">stgaus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">sfclust</span><span class="op">(</span><span class="va">stgaus</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu">f</span><span class="op">(</span><span class="va">idt</span>, model <span class="op">=</span> <span class="st">"rw1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  niter <span class="op">=</span> <span class="fl">10</span>, nmessage <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 1: clusters = 10, births = 0, deaths = 0, changes = 0, hypers = 0, log_mlike = -1295.25478118879</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 2: clusters = 9, births = 0, deaths = 1, changes = 0, hypers = 0, log_mlike = -1254.15930271047</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 3: clusters = 9, births = 0, deaths = 1, changes = 0, hypers = 0, log_mlike = -1254.15930271047</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 4: clusters = 10, births = 1, deaths = 1, changes = 0, hypers = 0, log_mlike = -1038.07772493223</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 5: clusters = 10, births = 1, deaths = 1, changes = 0, hypers = 0, log_mlike = -1038.07772493223</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 6: clusters = 11, births = 2, deaths = 1, changes = 0, hypers = 0, log_mlike = -886.210206401372</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 7: clusters = 11, births = 2, deaths = 1, changes = 0, hypers = 1, log_mlike = -886.210206401372</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 8: clusters = 11, births = 2, deaths = 1, changes = 0, hypers = 1, log_mlike = -886.210206401372</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 9: clusters = 11, births = 2, deaths = 1, changes = 0, hypers = 1, log_mlike = -886.210206401372</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 10: clusters = 11, births = 2, deaths = 1, changes = 0, hypers = 1, log_mlike = -886.210206401372</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within-cluster formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ f(idt, model = "rw1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering hyperparameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   log(1-q)      birth      death     change      hyper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.6931472  0.4250000  0.4250000  0.1000000  0.0500000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering movement counts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  births  deaths changes  hypers </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2       1       0       1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log marginal likelihood (sample 10 out of 10): -886.2102</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary for clustering sample 10 out of 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within-cluster formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ f(idt, model = "rw1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts per cluster:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3  4  5  6  7  8  9 10 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  1  1  5  2  1  1  1  5  2  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log marginal likelihood:  -886.2102 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sfclust-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering with binomial data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">stbinom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">sfclust</span><span class="op">(</span><span class="va">stbinom</span>, formula <span class="op">=</span> <span class="va">cases</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">f</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"binomial"</span>, Ntrials <span class="op">=</span> <span class="va">population</span>, niter <span class="op">=</span> <span class="fl">10</span>, nmessage <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Log marginal-likelihood correction not required.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 1: clusters = 9, births = 0, deaths = 1, changes = 0, hypers = 0, log_mlike = -76059.6237202677</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 2: clusters = 9, births = 0, deaths = 1, changes = 1, hypers = 0, log_mlike = -75981.5138547954</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 3: clusters = 9, births = 0, deaths = 1, changes = 1, hypers = 0, log_mlike = -75981.5138547954</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 4: clusters = 9, births = 0, deaths = 1, changes = 1, hypers = 0, log_mlike = -75981.5138547954</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 5: clusters = 9, births = 0, deaths = 1, changes = 1, hypers = 0, log_mlike = -75981.5138547954</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 6: clusters = 9, births = 0, deaths = 1, changes = 1, hypers = 0, log_mlike = -75981.5138547954</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 7: clusters = 10, births = 1, deaths = 1, changes = 1, hypers = 0, log_mlike = -75620.1013156549</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 8: clusters = 10, births = 1, deaths = 1, changes = 1, hypers = 0, log_mlike = -75620.1013156549</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 9: clusters = 10, births = 1, deaths = 1, changes = 1, hypers = 0, log_mlike = -75620.1013156549</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 10: clusters = 10, births = 1, deaths = 1, changes = 1, hypers = 0, log_mlike = -75620.1013156549</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within-cluster formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases ~ poly(time, 2) + f(id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering hyperparameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   log(1-q)      birth      death     change      hyper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.6931472  0.4250000  0.4250000  0.1000000  0.0500000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering movement counts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  births  deaths changes  hypers </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1       1       1       0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log marginal likelihood (sample 10 out of 10): -75620.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary for clustering sample 10 out of 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within-cluster formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases ~ poly(time, 2) + f(id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts per cluster:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3  4  5  6  7  8  9 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  1  1  1  2  8  1  1 19  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log marginal likelihood:  -75620.1 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sfclust-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erick A. Chacón-Montalván, Ruiman Zhong, Paula Moraga.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

