% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model-within.R
\name{log_mlik_each}
\alias{log_mlik_each}
\title{Evaluate Log Marginal Likelihood for Each Cluster Using INLA}
\usage{
log_mlik_each(
  k,
  stars_obj,
  membership,
  formula,
  family = "normal",
  correction = FALSE,
  stnames,
  N_var,
  detailed = FALSE,
  ...
)
}
\arguments{
\item{k}{Integer, the cluster index for which to compute the log marginal likelihood.}

\item{stars_obj}{A stars object containing spatial data, including covariates and response variables.}

\item{membership}{Integer vector, indicating the cluster membership of each observation.}

\item{formula}{Object of class \code{\link[stats]{formula}}, specifying the model to be fitted.}

\item{family}{Character string specifying the family of the model, with support for "normal", "poisson",
"binomial", and "nbinomial" (negative binomial variant 1); defaults to "normal".}

\item{correction}{Logical, indicating whether a correction should be applied to the computed log marginal
likelihood; defaults to FALSE.}

\item{stnames}{The name of the time variable in the stars object.}

\item{N_var}{The name of the variable used as exposure or trials (for Poisson, binomial, etc.).}

\item{detailed}{Logical, specifying whether to return the full model object or just the log marginal
likelihood; defaults to FALSE.}

\item{...}{Additional arguments passed to the INLA function.}
}
\value{
Depending on the \code{detailed} parameter:
\itemize{
\item If \code{detailed} is TRUE, returns the full \code{INLA} model object.
\item If \code{detailed} is FALSE, returns the log marginal likelihood (corrected if \code{correction} is TRUE).
}
}
\description{
This function computes the log marginal likelihood for a specific cluster \code{k} within a dataset.
It supports multiple family distributions and allows for the inclusion of exposure or trial sizes if applicable.
The function is flexible, accepting custom formulas and additional arguments for the INLA model fitting.
}
\examples{
\dontrun{
stars_obj <- create_stars_object(...)
membership <- sample(1:2, 10, replace = TRUE)
formula <- Y ~ temperature + precipitation + f(ids, model = "iid")
result <- log_mlik_each(1, stars_obj, membership, formula = formula, family = "poisson", correction = TRUE)
}
}
